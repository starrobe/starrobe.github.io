import{_ as F}from"./ValaxyMain.vue_vue_type_style_index_0_lang-d8ab152d.js";import{_ as y,u as D,p as i,c as C,w as o,o as A,a as s,b as l,d as e,r as t,e as d}from"./app-2781ddff.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-e8642e2c.js";import"./YunCard.vue_vue_type_script_setup_true_lang-7e7da48c.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-ebad1ef6.js";const po=JSON.parse('{"title":"Effective C++","description":"","frontmatter":{"layout":"post","title":"Effective C++","date":"2023-05-18T17:33:27.000Z","categories":"笔记","tags":["C++"]},"headers":[{"level":3,"title":"习惯C++","slug":"习惯c","link":"#习惯c","children":[]},{"level":3,"title":"构造/析构/赋值运算","slug":"构造-析构-赋值运算","link":"#构造-析构-赋值运算","children":[]},{"level":3,"title":"资源管理","slug":"资源管理","link":"#资源管理","children":[]},{"level":3,"title":"设计与声明","slug":"设计与声明","link":"#设计与声明","children":[]},{"level":3,"title":"实现","slug":"实现","link":"#实现","children":[]},{"level":3,"title":"继承于面向对象设计","slug":"继承于面向对象设计","link":"#继承于面向对象设计","children":[]},{"level":3,"title":"模板与泛型编程","slug":"模板与泛型编程","link":"#模板与泛型编程","children":[]},{"level":3,"title":"定制new和delete","slug":"定制new和delete","link":"#定制new和delete","children":[]}],"relativePath":"pages/posts/effective-cplusplus.md","path":"/home/runner/work/valaxy/valaxy/pages/posts/effective-cplusplus.md","lastUpdated":1692888211000}'),c=JSON.parse('{"title":"Effective C++","description":"","frontmatter":{"layout":"post","title":"Effective C++","date":"2023-05-18T17:33:27.000Z","categories":"笔记","tags":["C++"]},"headers":[{"level":3,"title":"习惯C++","slug":"习惯c","link":"#习惯c","children":[]},{"level":3,"title":"构造/析构/赋值运算","slug":"构造-析构-赋值运算","link":"#构造-析构-赋值运算","children":[]},{"level":3,"title":"资源管理","slug":"资源管理","link":"#资源管理","children":[]},{"level":3,"title":"设计与声明","slug":"设计与声明","link":"#设计与声明","children":[]},{"level":3,"title":"实现","slug":"实现","link":"#实现","children":[]},{"level":3,"title":"继承于面向对象设计","slug":"继承于面向对象设计","link":"#继承于面向对象设计","children":[]},{"level":3,"title":"模板与泛型编程","slug":"模板与泛型编程","link":"#模板与泛型编程","children":[]},{"level":3,"title":"定制new和delete","slug":"定制new和delete","link":"#定制new和delete","children":[]}],"relativePath":"pages/posts/effective-cplusplus.md","path":"/home/runner/work/valaxy/valaxy/pages/posts/effective-cplusplus.md","lastUpdated":1692888211000}'),h={name:"pages/posts/effective-cplusplus.md",data(){return{data:c,frontmatter:c.frontmatter,$frontmatter:c.frontmatter}},setup(){const a=D();a.meta.frontmatter=Object.assign(a.meta.frontmatter,c.frontmatter),i("pageData",c)}},u={id:"习惯c",tabindex:"-1"},B={id:"条款01-视c-为一个语言联邦",tabindex:"-1"},_=s("p",null,"C++高效编程守则视状况而变化，取决使用的是C++的哪一部分",-1),f=s("ul",null,[s("li",null,"C"),s("li",null,"Object-Oriented C++"),s("li",null,"Template C++"),s("li",null,"STL")],-1),m={id:"条款02-尽量以const-enum-inline替换-define",tabindex:"-1"},E=s("p",null,"当编译器不允许在class中为static常量赋初值，但又需要一个初值时",-1),g=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Entity")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"private"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"static"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#F07178"}}," Num "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD"}},"m_Array"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#F07178"}},"Num"),s("span",{style:{color:"#89DDFF"}},"];")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Entity"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#A6ACCD"}},"Num"),s("span",{style:{color:"#89DDFF"}},";")])])])],-1),w=s("p",null,[l('可使用"the enum hack"补偿做法('),s("em",null,"在模板元编程常用到"),l(")")],-1),v=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Entity")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"private"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"enum"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"{"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD"}},"Num"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD"}},"m_Array"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#F07178"}},"Num"),s("span",{style:{color:"#89DDFF"}},"];")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")])])])],-1),b=s("p",null,"对于",-1),T=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"#define"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"CALL_WITH_MAX"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"a"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"b"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," f((a) > (b) ? (a): (b))")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#A6ACCD"}}," a "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"5"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," b "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"CALL_WITH_MAX"),s("span",{style:{color:"#89DDFF"}},"(++"),s("span",{style:{color:"#A6ACCD"}},"a"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," b"),s("span",{style:{color:"#89DDFF"}},");"),s("span",{style:{color:"#676E95","font-style":"italic"}},"       // a累加两次")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"CALL_WITH_MAX"),s("span",{style:{color:"#89DDFF"}},"(++"),s("span",{style:{color:"#A6ACCD"}},"a"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," b "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"10"),s("span",{style:{color:"#89DDFF"}},");"),s("span",{style:{color:"#676E95","font-style":"italic"}},"  // a累加一次")])])])],-1),k=s("p",null,"使用如下替代",-1),x=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"inline"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"callWithMax"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"a"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"b"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#82AAFF"}},"f"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"a "),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," b "),s("span",{style:{color:"#89DDFF"}},"?"),s("span",{style:{color:"#A6ACCD"}}," a "),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," b"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])],-1),W=s("ul",null,[s("li",null,"对于单纯常量，最好以const对象或enum替换#define"),s("li",null,"对于形似函数的宏，最好改用inline函数替换#define")],-1),R={id:"条款03-尽可能使用const",tabindex:"-1"},z=s("p",null,"在class中定义const成员函数时，如果出现const版本与非const版本内容过长并且重复时",-1),S=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"TextBlock")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"char&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#FFCB6B"}},"[]"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#C792EA"}},"size_t"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"position"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"const")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    ...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD"}},"text"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#F07178"}},"position"),s("span",{style:{color:"#89DDFF"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"char&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#FFCB6B"}},"[]"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#C792EA"}},"size_t"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"position"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    ...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD"}},"text"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#F07178"}},"position"),s("span",{style:{color:"#89DDFF"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"private"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F07178"}},"string text"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")])])])],-1),I=s("p",null,"可使用非const版本调用const版本，避免重复",-1),M=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"char&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#FFCB6B"}},"[]"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#C792EA"}},"size_t"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"position"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"const_cast<"),s("span",{style:{color:"#C792EA"}},"char"),s("span",{style:{color:"#89DDFF"}},"&>(static_cast<"),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," TextBlock"),s("span",{style:{color:"#89DDFF"}},">(*this)["),s("span",{style:{color:"#A6ACCD"}},"position"),s("span",{style:{color:"#89DDFF"}},"]);")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])],-1),N={id:"条款04-确定对象被使用前已先被初始化",tabindex:"-1"},H=s("ul",null,[s("li",null,[s("p",null,"为内置型对象进行手工初始化，因为C++不保证初始化他们")]),s("li",null,[s("p",null,"构造函数最好使用成员初始化列表，而不要在构造函数内使用赋值操作")]),s("li",null,[s("p",null,'为避免"跨编译单元的初始化次序"问题，以local static对象代替non-local static对象'),s("blockquote",null,[s("p",null,"local static对象指的是函数内的static对象")])])],-1),O={id:"构造-析构-赋值运算",tabindex:"-1"},$={id:"条款05-了解c-合成并调用了哪些函数",tabindex:"-1"},L={id:"条款06-不想使用编译器自动生成的函数-就应该明确拒接",tabindex:"-1"},P={id:"条款07-为多态基类声明virtual析构",tabindex:"-1"},q=s("ul",null,[s("li",null,[s("p",null,"带多态时，基类应该声明一个虚析构。如果类有任何虚函数，它就应该有一个虚析构函数")]),s("li",null,[s("p",null,"如果类的设计不是作为基类使用，或不是为了多态，就不应该声明虚析构函数"),s("blockquote",null,[s("p",null,"虚函数会生成虚表指针，增加类的大小")])])],-1),V={id:"条款08-别让异常逃离析构函数",tabindex:"-1"},X=s("ul",null,[s("li",null,"析构函数不要吐出异常，如果一个被析构函数调用的函数抛出异常，析构函数应该捕捉任何异常， 然后吞下它们或结束程序"),s("li",null,"如果需要对某个操作函数运行期间抛出的异常做出反应，那么class应该提供一个普通函数执行该操作 而不是在析构函数中执行操作")],-1),j={id:"条款09-不在构造和析构函数过程中调用虚函数",tabindex:"-1"},G={id:"条款10-令operator-返回一个reference-to-this",tabindex:"-1"},J={id:"条款11-在operator-中处理自赋值",tabindex:"-1"},U=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Bitmap"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"{"),s("span",{style:{color:"#F07178"}}," ... "),s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  ...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"private"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  Bitmap"),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#F07178"}}," pb"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")])])])],-1),Z=s("ul",null,[s("li",null,[s("p",null,"认同测试检验自赋值，但不具备异常安全性。当new Bitmap异常时，pd指向一块被删除的空间"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#FFCB6B"}},"="),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"rhs"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"(this"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"=="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"&"),s("span",{style:{color:"#A6ACCD"}},"rhs"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"*this;")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF"}},"delete"),s("span",{style:{color:"#A6ACCD"}}," pb"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  pd "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"new"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"Bitmap"),s("span",{style:{color:"#89DDFF"}},"(*"),s("span",{style:{color:"#A6ACCD"}},"rhs"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"pb"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"*this;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])])]),s("li",null,[s("p",null,"在复制pb所指内容之前，不删除pb"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#FFCB6B"}},"="),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"rhs"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  Bitmap"),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD"}}," pOrign "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," pb"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  pd "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"new"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"Bitmap"),s("span",{style:{color:"#89DDFF"}},"(*"),s("span",{style:{color:"#A6ACCD"}},"rhs"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"pb"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF"}},"delete"),s("span",{style:{color:"#A6ACCD"}}," pOrign"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"*this;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])])]),s("li",null,[s("p",null,"copy and swap"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"swap"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"lhs"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"rhs"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"  // 交换lhs与rhs的数据")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#FFCB6B"}},"="),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"rhs"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  Widget "),s("span",{style:{color:"#82AAFF"}},"temp"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"rhs"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#82AAFF"}},"swap"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"temp"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"*this);")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"*this;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"/* 或者直接在实参传递时copy */")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#FFCB6B"}},"="),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"rhs"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#82AAFF"}},"swap"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"rhs"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"*this);")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"*this;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])])])],-1),K={id:"条款12-复制对象时不要遗漏成员",tabindex:"-1"},Q=s("ul",null,[s("li",null,'拷贝函数应该确保复制"对象的所有成员变量"以及"所有base class部分"'),s("li",null,"拷贝构造与拷贝运算符不要相互调用，避免代码重复的话可共同调用第三个函数如init()")],-1),Y={id:"资源管理",tabindex:"-1"},ss={id:"条款13-以对象管理资源",tabindex:"-1"},ls=s("ul",null,[s("li",null,[s("p",null,"为防止资源泄露，请使用RAII对象，他们在构造函数中获得资源并在析构函数中释放资源"),s("blockquote",null,[s("p",null,"RAII即Resource Acquisition Is Initalization，资源获取即初始化")])])],-1),os={id:"条款14-在资源管理类中小心拷贝行为",tabindex:"-1"},ns=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Lock")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"explicit"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"Lock"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"Mutex"),s("span",{style:{color:"#C792EA"}},"*"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"pm"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"mutexPtr"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"pm"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"{"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"lock"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"mutexPtr"),s("span",{style:{color:"#89DDFF"}},");"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#82AAFF"}},"~Lock"),s("span",{style:{color:"#89DDFF"}},"()"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"{"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"unlock"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"mutexPtr"),s("span",{style:{color:"#89DDFF"}},");"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"private"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  Mutex"),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#F07178"}}," mutexPtr"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")])])])],-1),es=s("ul",null,[s("li",null,[s("p",null,"禁止复制")]),s("li",null,[s("p",null,"引用计数"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Lock")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"explicit"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"Lock"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"Mutex"),s("span",{style:{color:"#C792EA"}},"*"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"pm"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"mutexPtr"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"pm"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," unlock"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"{"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"lock"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"mutexPtr"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"get"),s("span",{style:{color:"#89DDFF"}},"());"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"private"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F07178"}},"shared_ptr"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"Mutex"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#F07178"}}," mutexPtr"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")])])])])])],-1),as={id:"条款15-在资源管理类中提供对原始资源的访问",tabindex:"-1"},ts=s("ul",null,[s("li",null,[l("每个RAII class应该提供一个取得所管理资源的办法 "),s("ul",null,[s("li",null,"显示转换：定义get()"),s("li",null,[l("隐式转换：类型转换运算符operator "),s("em",null,"type"),l("() const;")])])])],-1),cs={id:"条款16-成对使用new和delete时采取相同形式",tabindex:"-1"},ps={id:"条款17-以独立语句将newed对象置入智能指针",tabindex:"-1"},rs=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"priority"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"processWidget"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"shared_ptr"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},">,"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"processWidget"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#82AAFF"}},"shared_ptr"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},">(new"),s("span",{style:{color:"#A6ACCD"}}," Widget"),s("span",{style:{color:"#89DDFF"}},"),"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"priority"),s("span",{style:{color:"#89DDFF"}},"());")])])])],-1),Fs=s("p",null,[l("实参的运行次序是不定的，当priority()在new Widget与"),s("code",null,"shared_ptr"),l("构造函数之间运行时，如果导致异常new Widget返回的 指针将会遗失，造成资源泄露。因此应该使用分离语句")],-1),ys=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"shared_ptr"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"pw"),s("span",{style:{color:"#89DDFF"}},"(new"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"Widget"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"processWidget"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"pw"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"priority"),s("span",{style:{color:"#89DDFF"}},"());")])])])],-1),Ds={id:"设计与声明",tabindex:"-1"},is={id:"条款18-让接口容易被正确使用-不易被误用",tabindex:"-1"},Cs={id:"条款19-设计class犹如type",tabindex:"-1"},As={id:"条款20-传const引用替换传值",tabindex:"-1"},ds=s("ul",null,[s("li",null,[s("p",null,[l("尽量以"),s("em",null,"pass-py-reference-to-const"),l("替换"),s("em",null,"pass-py-value"),l("，前者通常比较高效，并可避免切割问题")]),s("blockquote",null,[s("p",null,"切割问题指在动态类型中，只有子类指针与引用具备多态，其他情况下用子类表示基类会导致子类的特殊部分 被切割")])]),s("li",null,[s("p",null,[l("以上规则并不适用于内置类型，以及STL的迭代器和函数对象。对他们而言，"),s("em",null,"pass-py-value"),l("往往比较适当")])])],-1),hs={id:"条款21-必须返回对象时不要返回引用",tabindex:"-1"},us={id:"条款22-将成员变量声明为private",tabindex:"-1"},Bs=s("p",null,"protected并不比public更有封装性。当一个public变量被取消时，会破坏所有使用它的代码，protected同理， 会破坏所有子类中使用它的代码。",-1),_s=s("p",null,"因此只有两种访问权限：private(提供封装)和其他(不提供封装)",-1),fs={id:"条框23-以non-member、non-friend替代member函数",tabindex:"-1"},ms=s("p",null,"可增加封装性、包裹弹性以及机能扩充性",-1),Es={id:"条框24-若所有参数都需要类型转换-请采用non-member函数",tabindex:"-1"},gs=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#FFCB6B"}},"*"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"rhs"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    ...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Rational test"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," result"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"result "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," test "),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"2"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"result "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"2"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD"}}," test"),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#676E95","font-style":"italic"}},"  // 并不能通过编译")])])])],-1),ws=s("p",null,"需要为函数的所有参数进行类型转换时，这个函数必须为non-member",-1),vs=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#FFCB6B"}},"*"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"lhs"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"rhs"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," ...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])],-1),bs={id:"条款25-考虑写个不抛异常的swap函数",tabindex:"-1"},Ts=s("ul",null,[s("li",null,[s("p",null,"当std::swap对自定义类型效率不高时，提供一个swap成员函数，并确定这个函数不抛出异常")]),s("li",null,[s("p",null,"如果提供了一个member swap，也该提供一个non-member swap调用前者。对于非模板类也请特化std::swap"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"swap"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"other"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#F78C6C"}},"using"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F07178"}},"swap"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#82AAFF"}},"swap"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"xxx"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD"}},"other"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"xxx"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"namespace"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"std")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#89DDFF"}},"<>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"swap"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},">("),s("span",{style:{color:"#F07178"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"&"),s("span",{style:{color:"#F07178"}}," a"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," Widget"),s("span",{style:{color:"#89DDFF"}},"&"),s("span",{style:{color:"#F07178"}}," b"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#A6ACCD"}},"a"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"swap"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"b"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])]),s("p",null,"但当Widget为模板类时，就无法特化std::swap"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"namespace"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"std")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"swap"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">>("),s("span",{style:{color:"#F07178"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"T"),s("span",{style:{color:"#89DDFF"}},">&"),s("span",{style:{color:"#F07178"}}," a"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," Widget"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"T"),s("span",{style:{color:"#89DDFF"}},">&"),s("span",{style:{color:"#F07178"}}," b"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#A6ACCD"}},"a"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"swap"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"b"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"  // 上面为部分特化，而函数不支持部分特化")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"  // 相当于将T1特化为Widget(我猜的)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"  // template<typename T1, typename T>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"  // void swap<T1<T>>(T1<T>&, T1<T>&)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])])]),s("li",null,[s("p",null,[l("调用swap时应声明"),s("code",null,"using std::swap"),l("，然后调用不带任何命名空间修饰的swap。这样编译器会先择合适的swap")])]),s("li",null,[s("p",null,"为自定义类型进行std template全特化是好的，但不要尝试在std中加入新的东西"),s("p",null,"模板类时，无法部分特化std::swap函数，但可以重载std::swap。不过重载属于添加新的模板，不推荐"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"namespace"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"std")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"swap"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"a"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"b"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#A6ACCD"}},"a"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"swap"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"b"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])]),s("p",null,"但可以重新声明个non-member swap来调用member swap"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"namespace"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"WidgetStuff")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"{"),s("span",{style:{color:"#F07178"}}," ... "),s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  ...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"swap"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"a"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"b"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#A6ACCD"}},"a"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"swap"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"b"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])])])],-1),ks={id:"实现",tabindex:"-1"},xs={id:"条款26-尽可能延后变量定义的时间",tabindex:"-1"},Ws={id:"条款27-少做类型转换",tabindex:"-1"},Rs={id:"条款28-避免返回handles指向对象内部成分",tabindex:"-1"},zs=s("blockquote",null,[s("p",null,"handles(号码牌，用来取得某个对象)指引用、指针和迭代器")],-1),Ss={id:"条款29-为异常安全努力",tabindex:"-1"},Is={id:"条款30-透彻了解inline",tabindex:"-1"},Ms={id:"条款31-将文件的编译依存关系降到最低",tabindex:"-1"},Ns={id:"继承于面向对象设计",tabindex:"-1"},Hs={id:"条款32-public继承塑造出is-a关系",tabindex:"-1"},Os=s("p",null,[s("code",null,"class derived : public base"),l("即derived is a base")],-1),$s={id:"条款33-避免遮掩继承来的名称",tabindex:"-1"},Ls=s("p",null,"derived class 内的名称会遮掩base class 中的名称。为避免，可在基类使用using声明",-1),Ps=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Base")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"mf3"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Derived")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#F78C6C"}},"using"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Base"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F07178"}},"mf3"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"  // 因为在作用域按名称查找，当前作用域中只要名称匹配就会停止，无匹配才会向外继续查找")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"mf3"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")])])])],-1),qs={id:"条款34-区分接口设计与实现继承",tabindex:"-1"},Vs={id:"条款35-考虑virtual函数以外的其他选择",tabindex:"-1"},Xs=s("ul",null,[s("li",null,[l("non-virtual interface(NVI)手法。是"),s("em",null,"Template Method"),l("设计模式的一种特殊形式，以public non-virtual 成员函数包裹低访问性(private, protected)的virtual函数")]),s("li",null,[l("将virtual函数替换为函数指针或std::function对象，这是"),s("em",null,"Strategy"),l("设计模式的一种形式")])],-1),js={id:"条款36-不重新定义继承而来的non-virtual函数",tabindex:"-1"},Gs={id:"条款37-不重新定义继承而来的缺省参数值",tabindex:"-1"},Js=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Shape")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"enum"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"ShapeColor"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"{"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD"}},"Red"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD"}},"Green"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD"}},"Blue"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"virtual"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"draw"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"ShapeColor"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"color"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F07178"}}," Red"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rectangle"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Shape")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"virtual"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"draw"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"ShapeColor"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"color"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F07178"}}," Green"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Shape"),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD"}}," pr "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"new"),s("span",{style:{color:"#A6ACCD"}}," Rectangle"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"pr"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"draw"),s("span",{style:{color:"#89DDFF"}},"();")])])])],-1),Us=s("p",null,[l("虽然draw函数会动态绑定，即调用Rectangle的draw。但draw函数的默认实参只能静态绑定， 即使用静态类型Shape的draw的默认实参"),s("br"),l(" 当Rectangle::draw()的默认实参定义与基类一样时，如果Shape类的默认实参改变，也就必须同时修改 Rectangle处的代码。可使用条款35中的NVI来解决，定义public函数调用virtual函数")],-1),Zs={id:"条款38-复合的has-a与-根据某物实现出",tabindex:"-1"},Ks=s("ul",null,[s("li",null,[s("p",null,"在应用域，复合意味着has-a。如：Person有一个Address"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Address"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Person")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  Address m_address"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])])]),s("li",null,[s("p",null,'在实现域，复合意味着"根据...实现出"。如：根据list实现Set'),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Set")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"private"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F07178"}},"list"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#F07178"}}," rep"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])])])],-1),Qs={id:"条款39-审慎地使用private继承",tabindex:"-1"},Ys=s("ul",null,[s("li",null,[s("p",null,[l("private继承意味着is-implemented-in-terms-of。通常比复合的级别低("),s("s",null,"优先使用聚合，但不知道此处级别低有没有其他含义"),l(")。但当子类需要访问基类protected 成员或需要重新定义virtual函数时，可以使用private继承")])]),s("li",null,[s("p",null,"和复合不同，private继承可以使empty base optimization(EBO，空白基类最优化)，可使对象尺寸最小化"),s("blockquote",null,[s("p",null,[l("空白类不是专指这样"),s("code",null,"class A {};"),l("，类中什么都没有。可能含有typedefs，enums，static成员变量 或non-virtual函数")])]),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"A"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"{};")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"B")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#F07178"}}," i"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  A a"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"// sizeof(B) > sizeof(int)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"// 但是class B: private A { int i; }; 这样sizeof(B) == sizeof(int)成立")])])])])])],-1),sl={id:"条款40-审慎使用多重继承",tabindex:"-1"},ll={id:"模板与泛型编程",tabindex:"-1"},ol={id:"条款41-了解隐式接口和编译期多态",tabindex:"-1"},nl=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#82AAFF"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"virtual"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"~Widget"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"virtual"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#C792EA"}},"size_t"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"size"),s("span",{style:{color:"#89DDFF"}},"()"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"virtual"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"normalize"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"swap"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  ...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"doProcessing"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"w"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"w"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"size"),s("span",{style:{color:"#89DDFF"}},"()"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"10"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"&&"),s("span",{style:{color:"#A6ACCD"}}," w "),s("span",{style:{color:"#89DDFF"}},"!="),s("span",{style:{color:"#A6ACCD"}}," otherWidget"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    Widget "),s("span",{style:{color:"#82AAFF"}},"temp"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"w"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#A6ACCD"}},"temp"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"normalize"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#A6ACCD"}},"temp"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"swap"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"w"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])],-1),el=s("p",null,"能在源码中找到的接口，称为显示接口，也就是它在源码中明确可见",-1),al=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"doProcessing"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"w"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"w"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"size"),s("span",{style:{color:"#89DDFF"}},"()"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"10"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"&&"),s("span",{style:{color:"#A6ACCD"}}," w "),s("span",{style:{color:"#89DDFF"}},"!="),s("span",{style:{color:"#A6ACCD"}}," otherWidget"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    Widget "),s("span",{style:{color:"#82AAFF"}},"temp"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"w"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#A6ACCD"}},"temp"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"normalize"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#A6ACCD"}},"temp"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"swap"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"w"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])],-1),tl=s("p",null,[l("w的类型T"),s("strong",null,"好像"),l("必须支持size，normalize和swap成员函数以及其他，这些便是T必须支持的隐式接口")],-1),cl=s("p",null,[l("凡是涉及w的函数调用，例如"),s("code",null,"operator>"),l("和operator!=，可能造成template具现化。以不同的template参数具现化 function template会导致调用不同的函数，这就是编译期多态")],-1),pl={id:"条款42-typename的双重意义",tabindex:"-1"},rl=s("ul",null,[s("li",null,"声明template参数时，class与typename是一样的"),s("li",null,"请使用typename标识嵌套从属类型名称，但不得在继承时的基类列表和成员初始化列表内以它作为基类修饰符")],-1),Fl={id:"条款43-处理模板化基类内的名称",tabindex:"-1"},yl=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"MsgSender")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"sendClear"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"LoggingMsgSender"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"MsgSender"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"sendClearMsg"),s("span",{style:{color:"#89DDFF"}},"()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#82AAFF"}},"sendClear"),s("span",{style:{color:"#89DDFF"}},"();"),s("span",{style:{color:"#676E95","font-style":"italic"}},"  // 无法通过编译，因为编译器无法知道MsgSender<T>是否有sendClear函数")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    ...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")])])])],-1),Dl=s("ul",null,[s("li",null,[l("使用"),s("code",null,"this->"),l("调用基类函数即"),s("code",null,"this->sendClear();")]),s("li",null,[l("使用using声明基类函数，"),s("code",null,"using MsgSender<T>::sendClear;")]),s("li",null,[l("明确指出函数位于基类，"),s("code",null,"MsgSender<T>::sendClear();"),l("，但如果被调用的为虚函数，就只会调用基类虚函数了")])],-1),il={id:"条款44-将与参数无关的代码抽离template",tabindex:"-1"},Cl={id:"条款45-运用成员函数模板接受所有兼容类型",tabindex:"-1"},Al={id:"条款46-需要类型转换时请为模板定义非成员模板",tabindex:"-1"},dl=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#82AAFF"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"numberator"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"denominator"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#FFCB6B"}},"*"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"lhs"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"rhs"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"one_half"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"2"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," result "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," one_half "),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"2"),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#676E95","font-style":"italic"}}," //无法通过编译")])])])],-1),hl=s("p",null,[s("code",null,"operator*"),l("为函数模板，在使用"),s("code",null,"one_half * 2"),l("时，会根据实参推到T,具现化一个"),s("code",null,"operator*")],-1),ul=s("p",null,[s("code",null,"one_half"),l("为"),s("code",null,"Rational<int>"),l('类型，很容易推出T为int，但第二个实参"2"并不能推导出'),s("code",null,"const Rational<T>&"),l(' 中的T。函数模板并不会在通过实参推到T时，将实参进行隐式转换，即不能将"2"隐式构造为'),s("code",null,"Rational<int>")],-1),Bl=s("p",null,[l("可将"),s("code",null,"operator*"),l("声明为friend函数，在声明"),s("code",null,"one_half"),l("时，"),s("code",null,"Rational<int>"),l("被具现化，friend也被自动声明，friend函数 并非函数模板，因此在调用时可以隐式转换")],-1),_l=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"friend"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#FFCB6B"}},"*"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"lhs"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"rhs"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#FFCB6B"}},"*"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"lhs"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"rhs"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])],-1),fl=s("p",null,[l("上述虽然可以通过编译，但由于类模板Rational中"),s("code",null,"operator*"),l("是个普通函数的友元声明，而非模板函数， 无法与下面的"),s("code",null,"operator*"),l("模板函数的定义链接")],-1),ml=s("ul",null,[s("li",null,[s("p",null,"可直接在模板类中声明并定义友元"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"friend"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#FFCB6B"}},"*"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"lhs"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"rhs"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  ...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])]),s("p",null,"由于类中定义默认为inline，可另外定义个函数进行相乘的逻辑，而用类内的函数调用")]),s("li",null,[s("p",null,"类前声明函数，类内声明友元，类外定义函数"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," clas Rational"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#FFCB6B"}},"*"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"lhs"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"rhs"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"friend"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#FFCB6B"}},"*"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">("),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"lhs"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"rhs"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"}")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#FFCB6B"}},"*"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"lhs"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Rational"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"rhs"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])])])],-1),El={id:"条款47-使用traits-classes表现类型信息",tabindex:"-1"},gl=s("ul",null,[s("li",null,[s("p",null,"Traits classes使得类型相关信息在编译期可用，它们以template和template特化完成实现")]),s("li",null,[s("p",null,"通过重载，traits classes可以在编译期对类型进行if...else"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"IterT"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"DistT"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"Advance"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"IterT"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"iter"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"DistT"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"d"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#89DDFF"}},"(typeid("),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"iterator_traits"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"IterT"),s("span",{style:{color:"#89DDFF"}},">::"),s("span",{style:{color:"#FFCB6B"}},"iterator_category"),s("span",{style:{color:"#89DDFF"}},"))")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#89DDFF"}},"=="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"typeid("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#A6ACCD"}},"random_access_iterator_tag"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  ...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])]),s("p",null,"在编译期就知道IterT的类型，但if语句在运行时才会核定，因此可通过函数重载实现在编译时的 if判断"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"IterT"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"DistT"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"doAdvance"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"IterT"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"iter"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"DistT"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"d"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"random_access_iterator_tag"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  iter "),s("span",{style:{color:"#89DDFF"}},"+="),s("span",{style:{color:"#A6ACCD"}}," d"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"IterT"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"DistT"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"doAdvance"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"IterT"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"iter"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"DistT"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"d"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"bidirectional_iterator_tag"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"d "),s("span",{style:{color:"#89DDFF"}},">="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"{"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"while"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"d"),s("span",{style:{color:"#89DDFF"}},"--)"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"++"),s("span",{style:{color:"#F07178"}},"iter"),s("span",{style:{color:"#89DDFF"}},";}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"else"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"{"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"while"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"d"),s("span",{style:{color:"#89DDFF"}},"++)"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#F07178"}},"iter"),s("span",{style:{color:"#89DDFF"}},";}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"IterT"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"DistT"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"Advance"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"IterT"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"iter"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"DistT"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"d"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#82AAFF"}},"doAdvance"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"iter"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," d"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"iterator_traits"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"IterT"),s("span",{style:{color:"#89DDFF"}},">::"),s("span",{style:{color:"#FFCB6B"}},"iterator_category"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])])])],-1),wl={id:"条款48-template元编程",tabindex:"-1"},vl={id:"定制new和delete",tabindex:"-1"},bl={id:"条款49-new-handler的行为",tabindex:"-1"},Tl=s("p",null,[l("当operator new抛出异常前，会先调用客户指定的错误处理函数new-handler。为了指定该函数，必须调用"),s("code",null,"set_new_handler")],-1),kl=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"namespace"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"std")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#F78C6C"}},"typedef"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"(*"),s("span",{style:{color:"#A6ACCD"}},"new_handler"),s("span",{style:{color:"#89DDFF"}},")();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#FFCB6B"}},"new_handler"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"set_new_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"new_handler"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"p"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"throw"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])],-1),xl=s("p",null,[s("code",null,"set_new_handler"),l("返回值指向的是被调用前正在执行(但马上要被p替换的)那个new-handler函数")],-1),Wl=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"OutOfMemeory"),s("span",{style:{color:"#89DDFF"}},"()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#A6ACCD"}},"cerr "),s("span",{style:{color:"#89DDFF"}},"<<"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"..."),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<<"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},"\\n"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#82AAFF"}},"abort"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"main"),s("span",{style:{color:"#89DDFF"}},"()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#82AAFF"}},"set_new_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"OutOfMemeory"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD"}}," pBigDataArrary "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"new"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C792EA"}},"int"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#F78C6C"}},"100000000L"),s("span",{style:{color:"#89DDFF"}},"];")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])],-1),Rl=s("p",null,"有时候需要以不同的方式处理内存分配失败的情况，希望不同的class有不同的处理",-1),zl=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"A")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"static"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"OutOfMemeory"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"B")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"static"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"OutOfMemeory"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"A"),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD"}}," pa "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"new"),s("span",{style:{color:"#A6ACCD"}}," A"),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#676E95","font-style":"italic"}}," // 分配失败时调用A::OutOfMemeory()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"B"),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD"}}," pb "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"new"),s("span",{style:{color:"#A6ACCD"}}," B"),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#676E95","font-style":"italic"}}," // 分配失败时调用B::OutOfMemeory()")])])])],-1),Sl=s("p",null,[l("并不支持class的专属new-handler，但为每个class提供自己的"),s("code",null,"set_new_handler"),l("和operator new即可")],-1),Il=s("ul",null,[s("li",null,[s("code",null,"set_new_handler"),l("指定class的专属new-handler")]),s("li",null,"operator new确保在分配class对象内存时，以class专属new-handler替换global new-handler")],-1),Ml=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"static"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"new_handler"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"set_new_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"new_handler"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"p"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"throw"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"static"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"void*"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"new"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#C792EA"}},"size_t"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"size"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"throw"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"bad_alloc"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"private"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"static"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F07178"}},"new_handler current_handler"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#A6ACCD"}},"new_handler "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#A6ACCD"}},"current_handler "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"nullptr;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"new_handler"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#82AAFF"}},"set_new_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"new_handler"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"p"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"throw"),s("span",{style:{color:"#89DDFF"}},"()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#A6ACCD"}},"new_handler old_handler "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," current_handler"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  current_handler "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," p"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#A6ACCD"}}," old_handler"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])],-1),Nl=s("p",null,[l("在operator new中，调用"),s("code",null,"std::set_new_handler"),l("，当global operator new无法分配足够内存，抛出异常后需要 将global new-handler恢复。而成功分配内存也需要恢复global new-handler，因此创建资源管理类")],-1),Hl=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"NewHandlerHolder")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"explicit"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"NewHandlerHolder"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"new_handler"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"nh"),s("span",{style:{color:"#89DDFF"}},"):"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"nh"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"{}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#82AAFF"}},"~NewHandlerHolder"),s("span",{style:{color:"#89DDFF"}},"()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#82AAFF"}},"set_new_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"handler"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#82AAFF"}},"NewHandlerHolder"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"NewHandlerHolder"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"delete"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#FFCB6B"}},"NewHandlerHolder"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#FFCB6B"}},"="),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"const"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"NewHandlerHolder"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"private"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F07178"}},"new_handler handler"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")])])])],-1),Ol=s("p",null,"此时，operator new实现",-1),$l=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"void*"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"new"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#C792EA"}},"size_t"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"size"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"throw"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"bad_alloc"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  NewHandlerHolder "),s("span",{style:{color:"#82AAFF"}},"h"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#82AAFF"}},"set_new_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"current_handler"),s("span",{style:{color:"#89DDFF"}},"));")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#A6ACCD"}}," ::operator "),s("span",{style:{color:"#89DDFF"}},"new("),s("span",{style:{color:"#A6ACCD"}},"size"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])],-1),Ll=s("p",null,[l("实现这一方案的代码并不因为class的不同而改变，类中的operator new，"),s("code",null,"set_new_handler"),l("函数可以进行复用 而非在每个想要自定义new-handler的类中，声明这些static函数以及定义static变量")],-1),Pl=s("p",null,[l("由于"),s("code",null,"current_handler"),l("为静态变量，如果直接继承，多个子类中的"),s("code",null,"current_handler"),l("是同一个，因此将父类定义成模板 每个子类继承的父类就不同")],-1),ql=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"template"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C792EA"}},"typename"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#676E95","font-style":"italic"}}," // T并没有被使用，只是便于生成不同的父类")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"NewHandlerSupport")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"static"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"new_handler"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"set_new_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"new_handler"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"p"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"throw"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"static"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"void*"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"new"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#C792EA"}},"size_t"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"size"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"throw"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"bad_alloc"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"private"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"static"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F07178"}},"new_handler current_handler"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"NewHandlerSupport"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")])])])],-1),Vl=s("p",null,[l("operator new无法分配足够内存时，应该抛出"),s("code",null,"bad_alloc"),l("异常，但同时也可指定返回0即")],-1),Xl=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD"}}," p1 "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"new"),s("span",{style:{color:"#A6ACCD"}}," Widget"),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#676E95","font-style":"italic"}},"                // 失败时抛出异常")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD"}}," p2 "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"new("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#A6ACCD"}},"nothrow"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," Widget"),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#676E95","font-style":"italic"}},"  // 失败时返回0")])])])],-1),jl=s("blockquote",null,[s("p",null,"nothrow只是保证operator new，而new分配内存调用operator new后还会调用构造函数，因此new(std::nothrow) Widget还是会有异常")],-1),Gl={id:"条款50-new和delete的合理替换时机",tabindex:"-1"},Jl={id:"条款51-编写new和delete时需固守常规",tabindex:"-1"},Ul=s("ul",null,[s("li",null,[s("p",null,"operator new应该含有一个无限循环，在循环中分配内存，如果无法满足内存需求，就该调用new-handler。同时 也应该有处理0字节的申请。以及class专属版本中，如果子类(Derived)继承父类(Base)的operator new，此时的大小 为sizeof(Derived)，而调用的时Base::operator new，函数可能有依照sizeof(Base)设计的其他功能"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"void*"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"new"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#C792EA"}},"size_t"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"size"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"throw"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"bad_alloc"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"size "),s("span",{style:{color:"#89DDFF"}},"=="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#676E95","font-style":"italic"}}," //处理0字节申请")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    size "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"while"),s("span",{style:{color:"#89DDFF"}},"(true)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    分配size大小的内存")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"分配成功"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"      "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#F07178"}}," 地址"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"    // 获取当前new-handler，只能通过set_new_handler获得")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F07178"}},"new_handler global_handler "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#82AAFF"}},"set_new_handler"),s("span",{style:{color:"#89DDFF"}},"(nullptr);")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#82AAFF"}},"set_new_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"global_handler"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"global_handler"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"      "),s("span",{style:{color:"#82AAFF"}},"global_handler"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"    // 只有当new-handler指针为null时，才抛出异常")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"else"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"throw"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#82AAFF"}},"bad_alloc"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])]),s("p",null,"Base class专属operator new"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"void*"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Base"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"new"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#C792EA"}},"size_t"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"size"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"throw"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"bad_alloc"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"  // size为0或子类调用时，size与sizeof(Base)不等")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"size "),s("span",{style:{color:"#89DDFF"}},"!="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"sizeof("),s("span",{style:{color:"#A6ACCD"}},"Base"),s("span",{style:{color:"#89DDFF"}},"))")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#A6ACCD"}}," ::operator "),s("span",{style:{color:"#89DDFF"}},"new("),s("span",{style:{color:"#A6ACCD"}},"size"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  ...")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])])]),s("li",null,[s("p",null,"operator delete在收到nullptr时，不做任何事。class专属的operator delete应该处理大小不同的问题"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Base"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"delete"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"void*"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"raw_memory"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#C792EA"}},"size_t"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"size"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"raw_memory"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F07178"}},"size "),s("span",{style:{color:"#89DDFF"}},"!="),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF"}},"sizeof("),s("span",{style:{color:"#F07178"}},"Base"),s("span",{style:{color:"#89DDFF"}},"))")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"      ::operator "),s("span",{style:{color:"#89DDFF"}},"delete("),s("span",{style:{color:"#F07178"}},"raw_memory"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"      "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"}")])])])])])],-1),Zl={id:"条款52-写了placement-new也应有placement-delete",tabindex:"-1"},Kl=s("ul",null,[s("li",null,[s("p",null,"写了placement operator new也应该写出对于的placement operator delete"),s("p",null,"placement new指接受额外参数的operator new，placement delete指接受额外参数的operator delete"),s("blockquote",null,[s("p",null,"特别的一个placement new是，接受一个指针，指向对象该被构造的地址")]),s("p",null,"operator new成功分配内存，但对象构造时出现异常后，会调用operator delete恢复原先的内存， 而使用placement new后，如果没有对应的placement delete，就不会有任何的operator delete被调用"),s("p",null,"如果没有发生异常，在最终释放分配空间时"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"void*"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"new"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#C792EA"}},"size_t"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"size"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"ostream"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"log_stream"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"throw"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"bad_alloc"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"delete"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"void*"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"pmemory"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"throw"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"void"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"delete"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#C792EA"}},"void*"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"pmemory"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"ostream"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"log_stream"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"throw"),s("span",{style:{color:"#89DDFF"}},"();")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Widget"),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD"}}," pw "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"new("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#A6ACCD"}},"cerr"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," Widget"),s("span",{style:{color:"#89DDFF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"delete"),s("span",{style:{color:"#A6ACCD"}}," pw"),s("span",{style:{color:"#89DDFF"}},";")])])])]),s("p",null,'delete pw调用的是正常的operator new而非placement delete。placement delete只有在"伴随placement new调用而触发 的构造函数"出现异常时才会被调用。因此，除了placement delete外，还需提供一个正常的operator delete')]),s("li",null,[s("p",null,"当你声明placement new和placement delete，请不要遮掩正常版本"),s("p",null,"成员函数的名称会遮掩外围作用域中相同的名称"),s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"class"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"Base")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"public"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"  "),s("span",{style:{color:"#C792EA"}},"static"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#C792EA"}},"void*"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#F78C6C"}},"operator"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"new"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#C792EA"}},"size_t"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"size"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"ostream"),s("span",{style:{color:"#C792EA"}},"&"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#A6ACCD","font-style":"italic"}},"log_stream"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#F07178"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"throw"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"bad_alloc"),s("span",{style:{color:"#89DDFF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"};")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Base"),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD"}}," pb "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"new"),s("span",{style:{color:"#A6ACCD"}}," Base"),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#676E95","font-style":"italic"}},"            // 错误，正常形式的operator new被遮掩")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Base"),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD"}}," pb "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"new("),s("span",{style:{color:"#FFCB6B"}},"std"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#A6ACCD"}},"cerr"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," Base"),s("span",{style:{color:"#89DDFF"}},";")])])])])])],-1);function Ql(a,Yl,so,lo,p,oo){const n=d,r=F;return A(),C(r,{frontmatter:p.frontmatter,data:p.data},{"main-content-md":o(()=>[s("h3",u,[l("习惯C++ "),e(n,{class:"header-anchor",href:"#习惯c","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",B,[l("条款01：视C++为一个语言联邦 "),e(n,{class:"header-anchor",href:"#条款01-视c-为一个语言联邦","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),_,f,s("h4",m,[l("条款02 尽量以const, enum, inline替换 #define "),e(n,{class:"header-anchor",href:"#条款02-尽量以const-enum-inline替换-define","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),E,g,w,v,b,T,k,x,W,s("h4",R,[l("条款03 尽可能使用const "),e(n,{class:"header-anchor",href:"#条款03-尽可能使用const","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),z,S,I,M,s("h4",N,[l("条款04 确定对象被使用前已先被初始化 "),e(n,{class:"header-anchor",href:"#条款04-确定对象被使用前已先被初始化","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),H,s("h3",O,[l("构造/析构/赋值运算 "),e(n,{class:"header-anchor",href:"#构造-析构-赋值运算","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",$,[l("条款05 了解C++合成并调用了哪些函数 "),e(n,{class:"header-anchor",href:"#条款05-了解c-合成并调用了哪些函数","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",L,[l("条款06 不想使用编译器自动生成的函数，就应该明确拒接 "),e(n,{class:"header-anchor",href:"#条款06-不想使用编译器自动生成的函数-就应该明确拒接","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",P,[l("条款07 为多态基类声明virtual析构 "),e(n,{class:"header-anchor",href:"#条款07-为多态基类声明virtual析构","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),q,s("h4",V,[l("条款08 别让异常逃离析构函数 "),e(n,{class:"header-anchor",href:"#条款08-别让异常逃离析构函数","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),X,s("h4",j,[l("条款09 不在构造和析构函数过程中调用虚函数 "),e(n,{class:"header-anchor",href:"#条款09-不在构造和析构函数过程中调用虚函数","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",G,[l("条款10 令operator= 返回一个reference to *this "),e(n,{class:"header-anchor",href:"#条款10-令operator-返回一个reference-to-this","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",J,[l("条款11 在operator= 中处理自赋值 "),e(n,{class:"header-anchor",href:"#条款11-在operator-中处理自赋值","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),U,Z,s("h4",K,[l("条款12 复制对象时不要遗漏成员 "),e(n,{class:"header-anchor",href:"#条款12-复制对象时不要遗漏成员","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Q,s("h3",Y,[l("资源管理 "),e(n,{class:"header-anchor",href:"#资源管理","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",ss,[l("条款13 以对象管理资源 "),e(n,{class:"header-anchor",href:"#条款13-以对象管理资源","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),ls,s("h4",os,[l("条款14 在资源管理类中小心拷贝行为 "),e(n,{class:"header-anchor",href:"#条款14-在资源管理类中小心拷贝行为","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),ns,es,s("h4",as,[l("条款15 在资源管理类中提供对原始资源的访问 "),e(n,{class:"header-anchor",href:"#条款15-在资源管理类中提供对原始资源的访问","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),ts,s("h4",cs,[l("条款16 成对使用new和delete时采取相同形式 "),e(n,{class:"header-anchor",href:"#条款16-成对使用new和delete时采取相同形式","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",ps,[l("条款17 以独立语句将newed对象置入智能指针 "),e(n,{class:"header-anchor",href:"#条款17-以独立语句将newed对象置入智能指针","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),rs,Fs,ys,s("h3",Ds,[l("设计与声明 "),e(n,{class:"header-anchor",href:"#设计与声明","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",is,[l("条款18 让接口容易被正确使用，不易被误用 "),e(n,{class:"header-anchor",href:"#条款18-让接口容易被正确使用-不易被误用","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",Cs,[l("条款19 设计class犹如type "),e(n,{class:"header-anchor",href:"#条款19-设计class犹如type","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",As,[l("条款20 传const引用替换传值 "),e(n,{class:"header-anchor",href:"#条款20-传const引用替换传值","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),ds,s("h4",hs,[l("条款21 必须返回对象时不要返回引用 "),e(n,{class:"header-anchor",href:"#条款21-必须返回对象时不要返回引用","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",us,[l("条款22 将成员变量声明为private "),e(n,{class:"header-anchor",href:"#条款22-将成员变量声明为private","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Bs,_s,s("h4",fs,[l("条框23 以non-member、non-friend替代member函数 "),e(n,{class:"header-anchor",href:"#条框23-以non-member、non-friend替代member函数","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),ms,s("h4",Es,[l("条框24 若所有参数都需要类型转换，请采用non-member函数 "),e(n,{class:"header-anchor",href:"#条框24-若所有参数都需要类型转换-请采用non-member函数","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),gs,ws,vs,s("h4",bs,[l("条款25 考虑写个不抛异常的swap函数 "),e(n,{class:"header-anchor",href:"#条款25-考虑写个不抛异常的swap函数","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Ts,s("h3",ks,[l("实现 "),e(n,{class:"header-anchor",href:"#实现","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",xs,[l("条款26 尽可能延后变量定义的时间 "),e(n,{class:"header-anchor",href:"#条款26-尽可能延后变量定义的时间","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",Ws,[l("条款27 少做类型转换 "),e(n,{class:"header-anchor",href:"#条款27-少做类型转换","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",Rs,[l("条款28 避免返回handles指向对象内部成分 "),e(n,{class:"header-anchor",href:"#条款28-避免返回handles指向对象内部成分","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),zs,s("h4",Ss,[l("条款29 为异常安全努力 "),e(n,{class:"header-anchor",href:"#条款29-为异常安全努力","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",Is,[l("条款30 透彻了解inline "),e(n,{class:"header-anchor",href:"#条款30-透彻了解inline","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",Ms,[l("条款31 将文件的编译依存关系降到最低 "),e(n,{class:"header-anchor",href:"#条款31-将文件的编译依存关系降到最低","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h3",Ns,[l("继承于面向对象设计 "),e(n,{class:"header-anchor",href:"#继承于面向对象设计","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",Hs,[l("条款32 public继承塑造出is-a关系 "),e(n,{class:"header-anchor",href:"#条款32-public继承塑造出is-a关系","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Os,s("h4",$s,[l("条款33 避免遮掩继承来的名称 "),e(n,{class:"header-anchor",href:"#条款33-避免遮掩继承来的名称","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Ls,Ps,s("h4",qs,[l("条款34 区分接口设计与实现继承 "),e(n,{class:"header-anchor",href:"#条款34-区分接口设计与实现继承","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",Vs,[l("条款35 考虑virtual函数以外的其他选择 "),e(n,{class:"header-anchor",href:"#条款35-考虑virtual函数以外的其他选择","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Xs,s("h4",js,[l("条款36 不重新定义继承而来的non-virtual函数 "),e(n,{class:"header-anchor",href:"#条款36-不重新定义继承而来的non-virtual函数","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",Gs,[l("条款37 不重新定义继承而来的缺省参数值 "),e(n,{class:"header-anchor",href:"#条款37-不重新定义继承而来的缺省参数值","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Js,Us,s("h4",Zs,[l('条款38 复合的has-a与"根据某物实现出" '),e(n,{class:"header-anchor",href:"#条款38-复合的has-a与-根据某物实现出","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Ks,s("h4",Qs,[l("条款39 审慎地使用private继承 "),e(n,{class:"header-anchor",href:"#条款39-审慎地使用private继承","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Ys,s("h4",sl,[l("条款40 审慎使用多重继承 "),e(n,{class:"header-anchor",href:"#条款40-审慎使用多重继承","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h3",ll,[l("模板与泛型编程 "),e(n,{class:"header-anchor",href:"#模板与泛型编程","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",ol,[l("条款41 了解隐式接口和编译期多态 "),e(n,{class:"header-anchor",href:"#条款41-了解隐式接口和编译期多态","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),nl,el,al,tl,cl,s("h4",pl,[l("条款42 typename的双重意义 "),e(n,{class:"header-anchor",href:"#条款42-typename的双重意义","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),rl,s("h4",Fl,[l("条款43 处理模板化基类内的名称 "),e(n,{class:"header-anchor",href:"#条款43-处理模板化基类内的名称","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),yl,Dl,s("h4",il,[l("条款44 将与参数无关的代码抽离template "),e(n,{class:"header-anchor",href:"#条款44-将与参数无关的代码抽离template","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",Cl,[l("条款45 运用成员函数模板接受所有兼容类型 "),e(n,{class:"header-anchor",href:"#条款45-运用成员函数模板接受所有兼容类型","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",Al,[l("条款46 需要类型转换时请为模板定义非成员模板 "),e(n,{class:"header-anchor",href:"#条款46-需要类型转换时请为模板定义非成员模板","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),dl,hl,ul,Bl,_l,fl,ml,s("h4",El,[l("条款47 使用traits classes表现类型信息 "),e(n,{class:"header-anchor",href:"#条款47-使用traits-classes表现类型信息","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),gl,s("h4",wl,[l("条款48 template元编程 "),e(n,{class:"header-anchor",href:"#条款48-template元编程","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h3",vl,[l("定制new和delete "),e(n,{class:"header-anchor",href:"#定制new和delete","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",bl,[l("条款49 new-handler的行为 "),e(n,{class:"header-anchor",href:"#条款49-new-handler的行为","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Tl,kl,xl,Wl,Rl,zl,Sl,Il,Ml,Nl,Hl,Ol,$l,Ll,Pl,ql,Vl,Xl,jl,s("h4",Gl,[l("条款50 new和delete的合理替换时机 "),e(n,{class:"header-anchor",href:"#条款50-new和delete的合理替换时机","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h4",Jl,[l("条款51 编写new和delete时需固守常规 "),e(n,{class:"header-anchor",href:"#条款51-编写new和delete时需固守常规","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Ul,s("h4",Zl,[l("条款52 写了placement new也应有placement delete "),e(n,{class:"header-anchor",href:"#条款52-写了placement-new也应有placement-delete","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Kl]),"main-header":o(()=>[t(a.$slots,"main-header")]),"main-header-after":o(()=>[t(a.$slots,"main-header-after")]),"main-nav":o(()=>[t(a.$slots,"main-nav")]),"main-content":o(()=>[t(a.$slots,"main-content")]),"main-content-after":o(()=>[t(a.$slots,"main-content-after")]),"main-nav-before":o(()=>[t(a.$slots,"main-nav-before")]),"main-nav-after":o(()=>[t(a.$slots,"main-nav-after")]),comment:o(()=>[t(a.$slots,"comment")]),footer:o(()=>[t(a.$slots,"footer")]),aside:o(()=>[t(a.$slots,"aside")]),"aside-custom":o(()=>[t(a.$slots,"aside-custom")]),default:o(()=>[t(a.$slots,"default")]),_:3},8,["frontmatter","data"])}const ro=y(h,[["render",Ql]]);export{po as __pageData,ro as default};
